#!/bin/bash
set -ex
CLUSTER_NAME='karpenter-demo'
API_SERVER_URL=https://19318E35E5344B63CFDDE246A5B90C00.sk1.us-east-2.eks.amazonaws.com
B64_CLUSTER_CA=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1USXlOekl3TVRjMU5Gb1hEVE14TVRJeU5USXdNVGMxTkZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTG1ECi9pWUpNMGl6cnVMQXRyVDc3ZDIxTGJ5WVV4cUZwMnFUNlpjL0pKb29sN2NxT3BENTI3ejM0QkZ2alBCRElabHoKbFRnc3JNY3d0MFNrN0o1RWFDalFEMWI3TDA4OEU0TjJVeXNEempNY3duZnlTWS9XS09xenBzL0pYM1pISkt4QQpFTHlvaEFBTlVpTm5wMVQvT0Z4K2hvb2FBdkxKTzBRTkNiakpCN3dWUzhQbzJXSHRyb0RnM0N3Mko1L0E0bmx5CjN6V1NVRkdqbitJOGhFdllJbHc4T0hMVkZBckI0UnlKSjlRamJxSGsyMHBjQy9rak9iWWtXNHkwOVl5TGh3dUkKYWNidVJqOVJNWHE2RUhsMlNkQTAzV1d1MUlGZEFLUnZyWTEvMm9oWTU5YkNBbllSR1E1Y2dBQ1RKZi9DRkhGVgpJaW92VGlsOHVDTnpiNnBPbG0wQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZMZmI5Zm5nditCcjIwY1Q3Y3ltSWFwbk5xaEZNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFDSk0xVEFCRVYxUkVDWmR3Y1BWdFIzVmgyb3VwZHhUczA0b0pXV2piMWRML0NHVis5Uwp6MHpwWm9KKzBHZUJCb3BmWG02RkdTUHVFWTVhMGlNMVJoaXM3SnZBd3ZpMWpVd3RXRU9lV0VreHovT1JKYitwCjJOSXZDbzc3cEYxaTBRVnJnWFBadTNxc0FMV1pxM1BpemlOeDY4b2I2QlhaYklOVG9uNFNvd2haOEIxbTk5YjIKajV4NmUwbnEzcFVZK0RERnVPU1NiMkIvQUE3VXBvUUlobUZvWkJsdlRWL0hSbzgrTWJML1VvZXFKQTdEOTFSSwpRYzY2Z0pXaWF3MEQ5R0VPY0J5ZnR0ZWRaZVBkMkRuNHpkdVI4VHEvNm1WcEJkYjkxcnZKWTJyRFdiOTZNdVhoCmFBWWgzYjltM2s0Zzg3RmtJMkpoRk93aCtjRUhQZ2JlejZ1eAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
KUBELET_EXTRA_ARGS='--node-labels=node.k8s.aws/capacity-type=spot'
/etc/eks/bootstrap.sh $CLUSTER_NAME --kubelet-extra-args $KUBELET_EXTRA_ARGS --b64-cluster-ca $B64_CLUSTER_CA --apiserver-endpoint $API_SERVER_URL 