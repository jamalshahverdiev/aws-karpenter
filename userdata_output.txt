#!/bin/bash
set -ex
CLUSTER_NAME='karpenter-nonprod'
API_SERVER_URL=https://7B16DBD51F0A1C28AB74E2E0A2D08F6D.gr7.us-east-1.eks.amazonaws.com
B64_CLUSTER_CA=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1USXlOREE0TVRFeU1Gb1hEVE14TVRJeU1qQTRNVEV5TUZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTEVhCm4vak5CdWhHUVg5ZGtUSWFnYWU0SG9CTXlnTXJoN0NwQVlvN25pK0xmbHdiUHo3U21DY1kycGltU3pJNm56b28KTnFzL0JCSmxpTUljdGJWSUpsVXFOdmxUU0dLVkl5bVF6ZHRxK2FzNHpmUVRLYWR2UVBSdlhiRjBMWkoyMGZFNApCVlFRRkxPM3daa2U5U2ZZMGJyTituYk5LL2ZBdFJXN2NPVWlEb0lvRzNMenVkSzVDcUZwdkRXcG9LYzIxeDdnCjdrU3gwSjlZMnh1ZFRSQWtvUlQzajJhdG1CdFBwaXZJZnBzMU1ud2tJaVdPazl2VHNhd1piWTkrTS9XNTc2QkkKTzRLZEVZaGJDNmJnc1RyM3N5Y3kzb0gwamdIbHlXZnhTZnZ0S1ZvTjZCZ0RBcVo0QzBNM3pkR1YrNUdCbGNENAp1c2dxWXpTeDloQlpSeU53TTQ4Q0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZDUlZ4QjMrcXBXbi91cmUzbWY2eldMMjFvWktNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFDZVNueDFqcGpFcXJMS0VyVTVNVTBva1lPSXF5VU84ejZtK3BtQnhIUVNZMGpXcmNSKwpnMEE4NWljT1FSajFXWkNQTkVIcFJIN3JsTitGL0FXUG0wOWxrcUxvS0ErN2Z1REd6Vy8yZHRIY1FSZm1renN4CkYxQ0JGRElPNFVsenBZaytpQnFoTkVhMEZsOVlqYnloRm5BTVZjOUVmZnhzbUgrcTlPcXkvcWJiS2JxNGxDaEgKT0JhZlRCZWF1U1pJRThITmRuZWlXMkdVczcrVDA2TzdhRWZoOVhPWDFIWmVqaHFrTzJ5QjkyK2JBT3FHbE5jVgozZU42Qyt0ZmdlSGl3SnluaUpneWEvVzBCSHFtVTR0bEdXT0p0SmxvU0pNcG1lOXBwT0IwY3NnWHZNUkRWR2JkCjM2eGhrelh0eFJtQ1RQYk9GUXFYLzdUdjdWL2I2R0VrVUxxYQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
KUBELET_EXTRA_ARGS='--node-labels=node.k8s.aws/capacity-type=spot'
/etc/eks/bootstrap.sh $CLUSTER_NAME --kubelet-extra-args $KUBELET_EXTRA_ARGS --b64-cluster-ca $B64_CLUSTER_CA --apiserver-endpoint $API_SERVER_URL 